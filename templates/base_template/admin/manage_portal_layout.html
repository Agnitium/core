<script type="text/javascript">
$(document).ready(function(){
	$('#dw_portal_blocks').on('change', function(event){
		var checkedValues = $.map($(this).multiselect("getChecked"), function( input ){
			return input.value;
		});
		
		var allValues = $.map($('#dw_portal_blocks option'), function(e) { return e.value; });
		
		$.each(allValues, function(index, value) {
			if ($.inArray(value, checkedValues) > -1){
				//Show block
				$('#block_container_'+value).show();
			} else {
				//Hide block
				$('#block_container_'+value).hide();
				var childs = $('#'+value).children();
				$.each(childs, function(index, value2){
					$('#block_'+value2.id).val('disabled');
					$('#'+value2.id).addClass('portal_disabled').addClass('equalHeights');
					$('#disabled').append($('#'+value2.id));
				});
				$('#'+value).html('');
			}
		});
	});
});
</script>
<div class="breadcrumb-container">
	<ul class="breamcrumb">
		<li><a href="{EQDKP_CONTROLLER_PATH}{SID}" title="{L_home}"><i class="icon-home"></i></a></li>
		<li><a href="{EQDKP_ROOT_PATH}admin/{SID}">{L_menu_admin_panel}</a>
		<li><a href="{EQDKP_ROOT_PATH}admin/manage_portal.php{SID}">{L_portalmanager}</a>
		<li class="current"><a><!-- IF NAME == '' -->{L_add_portal_layout}<!-- ELSE -->{NAME}<!-- ENDIF --></a></li>
	</ul>
	<div class="clear"></div>
</div>

<form method="post" action="{ACTION}" name="post" id="portal_layout_form">
<div class="contentHeader">
	<h1 class="contentTitle">{L_portalplugin_management}</h1>
</div>

<fieldset class="settings">
	<dl>
		<dt><label>{L_name}:</label></dt>
		<dd><input type="text" name="name" value="{NAME}" class="input required" /></dd>
	</dl>
	<dl>
		<dt><label>{L_portal_blocks}:</label></dt>
		<dd>{MS_PORTAL_BLOCKS}</dd>
	</dl>
</fieldset>

<div class="contentDivider"></div>
<div>
{L_portalplugin_filter}: {PERM_FILTER}
</div>
<div id="positions">
	
	<br />
	<div style="float:left; width:25%; min-width:200px; <!-- IF S_LEFT_HIDDEN -->display:none;<!-- ENDIF -->" id="block_container_left">
		<div class="portal_block_border">
		<h2>{L_portalplugin_left}:</h2>
			<ul id="left" class="connectedSortable portal_block">
				<!-- BEGIN left_row -->
				<li class="ui-state-hover {left_row.CLASS}" id="item_{left_row.ID}" style="padding: 7px; margin-top: 4px;">
					{left_row.INFO}
					{left_row.NAME}
					<!-- IF left_row.S_MULTIPLE -->
					&nbsp;&nbsp;<a href="{ACTION}&amp;duplicate=true&amp;selected_id={left_row.ID}" title="{L_portal_duplicate}"><img src="{EQDKP_IMAGE_PATH}global/add.png" alt="Clone" style="float:right;" class="hand" /></a>
					<!-- ENDIF -->
					<!-- IF left_row.S_CHILD -->
					&nbsp;&nbsp;<img src="{EQDKP_IMAGE_PATH}global/delete.png" alt="u" title="{L_delete}" onclick="javascript:delete_portal({left_row.ID});" style="float:right;" class="hand" />
					<!-- ENDIF -->
					&nbsp;<img src="{EQDKP_IMAGE_PATH}global/edit.png" alt="s" title="{L_portalplugin_settings}" onclick="javascript:portalsettings($(this).parent().attr('id'));" style="float:right;" class="hand" />
					<input name="sort[][{left_row.ID}]" type="hidden" value="1" />
					<input type="hidden" name="pos[{left_row.ID}]" value="{left_row.POS}" id="block_item_{left_row.ID}" />
				</li>
				<!-- END left_row-->

			</ul>
		</div>
	</div>
	<div style="float:left; width:50%; min-width:400px;">
		<div class="portal_block_border" <!-- IF S_MIDDLE_HIDDEN -->style="display:none;"<!-- ENDIF --> id="block_container_middle">
			<h2>{L_portalplugin_middle}:</h2>
			<ul id="middle" class="connectedSortable portal_block">
				<!-- BEGIN middle_row -->
				<li class="ui-state-hover {middle_row.CLASS}" id="item_{middle_row.ID}" style="padding: 7px; margin-top: 4px;">
					{middle_row.INFO}
					{middle_row.NAME}
					<!-- IF middle_row.S_MULTIPLE -->
					&nbsp;<a href="{ACTION}&amp;duplicate=true&amp;selected_id={middle_row.ID}" title="{L_portal_duplicate}"><img src="{EQDKP_IMAGE_PATH}global/add.png" alt="Clone" style="float:right;" class="hand" /></a>
					<!-- ENDIF -->
					<!-- IF middle_row.S_CHILD -->
					&nbsp;&nbsp;<img src="{EQDKP_IMAGE_PATH}global/delete.png" alt="u" title="{L_delete}" onclick="javascript:delete_portal({middle_row.ID});" style="float:right;" class="hand" />
					<!-- ENDIF -->
					&nbsp;<img src="{EQDKP_IMAGE_PATH}global/edit.png" alt="s" title="{L_portalplugin_settings}" onclick="javascript:portalsettings($(this).parent().attr('id'));" style="float:right;" class="hand" />
					<input name="sort[][{middle_row.ID}]" type="hidden" value="1" />
					<input type="hidden" name="pos[{middle_row.ID}]" value="{middle_row.POS}" id="block_item_{middle_row.ID}" />
				</li>
				<!-- END middle_row-->
			</ul>
		</div>
		
		<div class="portal_block_light">
			<div style="height:100px;">{L_info_opt_content}</div>
		</div>
		
		<div class="portal_block_border" <!-- IF S_BOTTOM_HIDDEN -->style="display:none;"<!-- ENDIF --> id="block_container_bottom">
		<h2>{L_portalplugin_bottom}:</h2>
			<ul id="bottom" class="connectedSortable portal_block">
				<!-- BEGIN bottom_row -->
				<li class="ui-state-hover {bottom_row.CLASS}" id="item_{bottom_row.ID}" style="padding: 7px; margin-top: 4px;">
					{bottom_row.INFO}
					{bottom_row.NAME}
					<!-- IF bottom_row.S_MULTIPLE -->
					&nbsp;<a href="{ACTION}&amp;duplicate=true&amp;selected_id={bottom_row.ID}" title="{L_portal_duplicate}"><img src="{EQDKP_IMAGE_PATH}global/add.png" alt="Clone" style="float:right;" class="hand" /></a>
					<!-- ENDIF -->
					<!-- IF bottom_row.S_CHILD -->
					&nbsp;&nbsp;<img src="{EQDKP_IMAGE_PATH}global/delete.png" alt="u" title="{L_delete}" onclick="javascript:delete_portal({bottom_row.ID});" style="float:right;" class="hand" />
					<!-- ENDIF -->
					&nbsp;<img src="{EQDKP_IMAGE_PATH}global/edit.png" alt="s" title="{L_portalplugin_settings}" onclick="javascript:portalsettings($(this).parent().attr('id'));" style="float:right;" class="hand" />
					<input name="sort[][{bottom_row.ID}]" type="hidden" value="1" />
					<input type="hidden" name="pos[{bottom_row.ID}]" value="{bottom_row.POS}" id="block_item_{bottom_row.ID}" />
				</li>
				<!-- END bottom_row-->
			</ul>
		</div>	
	</div>
	
	<div style="float:left; width:25%; min-width:200px; <!-- IF S_RIGHT_HIDDEN -->display:none;<!-- ENDIF -->" id="block_container_right">
		<div class="portal_block_border">
		<h2>{L_portalplugin_right}:</h2>
			<ul id="right" class="connectedSortable portal_block">
				<!-- BEGIN right_row -->
				<li class="ui-state-hover {right_row.CLASS}" id="item_{right_row.ID}" style="padding: 7px; margin-top: 4px;">
					{right_row.INFO}
					{right_row.NAME}
					<!-- IF right_row.S_MULTIPLE -->
					&nbsp;<a href="{ACTION}&amp;duplicate=true&amp;selected_id={right_row.ID}" title="{L_portal_duplicate}"><img src="{EQDKP_IMAGE_PATH}global/add.png" alt="Clone" style="float:right;" class="hand" /></a>
					<!-- ENDIF -->
					<!-- IF right_row.S_CHILD -->
					&nbsp;&nbsp;<img src="{EQDKP_IMAGE_PATH}global/delete.png" alt="u" title="{L_delete}" onclick="javascript:delete_portal({right_row.ID});" style="float:right;" class="hand" />
					<!-- ENDIF -->
					&nbsp;<img src="{EQDKP_IMAGE_PATH}global/edit.png" alt="s" title="{L_portalplugin_settings}" onclick="javascript:portalsettings($(this).parent().attr('id'));" style="float:right;" class="hand" />
					<input name="sort[][{right_row.ID}]" type="hidden" value="1" />
					<input type="hidden" name="pos[{right_row.ID}]" value="{right_row.POS}" id="block_item_{right_row.ID}" />
				</li>
				<!-- END right_row-->
			</ul>
		</div>
	</div>
	<div style="clear:both;"></div>
	<!-- BEGIN block_row -->
	<div style="float:left; width:300px; <!-- IF block_row.S_HIDDEN -->display:none;<!-- ENDIF -->" id="block_container_block{block_row.ID}">
		<div class="portal_block_border">
		<h2>{block_row.NAME}:</h2>
			<ul id="block{block_row.ID}" class="connectedSortable portal_block">
				<!-- BEGIN module_row -->
				<li class="ui-state-hover {block_row.module_row.CLASS}" id="item_{block_row.module_row.ID}" style="padding: 7px; margin-top: 4px;">
					{block_row.module_row.INFO}
					{block_row.module_row.NAME}
					<!-- IF block_row.module_row.S_MULTIPLE -->
					&nbsp;<a href="{ACTION}&amp;duplicate=true&amp;selected_id={block_row.module_row.ID}" title="{L_portal_duplicate}"><img src="{EQDKP_IMAGE_PATH}global/add.png" alt="Clone" style="float:right;" class="hand" /></a>
					<!-- ENDIF -->
					<!-- IF block_row.module_row.S_CHILD -->
					&nbsp;&nbsp;<img src="{EQDKP_IMAGE_PATH}global/delete.png" alt="u" title="{L_delete}" onclick="javascript:delete_portal({block_row.module_row.ID});" style="float:right;" class="hand" />
					<!-- ENDIF -->
					&nbsp;<img src="{EQDKP_IMAGE_PATH}global/edit.png" alt="s" title="{L_portalplugin_settings}" onclick="javascript:portalsettings($(this).parent().attr('id'));" style="float:right;" class="hand" />
					<input name="sort[][{block_row.module_row.ID}]" type="hidden" value="1" />
					<input type="hidden" name="pos[{block_row.module_row.ID}]" value="{block_row.module_row.POS}" id="block_item_{block_row.module_row.ID}" />
				</li>
				<!-- END module_row-->
			</ul>
		</div>
	</div>
	<!-- END block_row -->
	
	<div style="clear:both;"></div>
	<div style="width:100%;">
		<div class="portal_block_border">
			<h2>{L_portalplugin_disabled}:</h2>
			<ul id="disabled" class="connectedSortable portal_block" style="float:left;">
				<!-- BEGIN disabled_row -->
				<li class="ui-state-hover {disabled_row.CLASS} portal_disabled equalHeights" id="item_{disabled_row.ID}" style="padding: 7px; margin-top: 4px;">
					{disabled_row.INFO}
					{disabled_row.NAME}
					<!-- IF disabled_row.S_MULTIPLE -->
					<a href="{ACTION}&amp;duplicate=true&amp;selected_id={disabled_row.ID}" title="{L_portal_duplicate}"><img src="{EQDKP_IMAGE_PATH}global/add.png" alt="Clone" style="float:right;" class="hand" /></a>
					<!-- ENDIF -->
					<!-- IF right_row.S_CHILD -->
					&nbsp;&nbsp;<img src="{EQDKP_IMAGE_PATH}global/delete.png" alt="u" title="{L_delete}" onclick="javascript:delete_portal({disabled_row.ID});" style="float:right;" class="hand" />
					<!-- ENDIF -->
					&nbsp;&nbsp;<img src="{EQDKP_IMAGE_PATH}global/edit.png" alt="s" title="{L_portalplugin_settings}" onclick="javascript:portalsettings($(this).parent().attr('id'));" style="float:right;" class="hand" />
					<input name="sort[][{disabled_row.ID}]" type="hidden" value="1" />
					<input type="hidden" name="pos[{disabled_row.ID}]" value="{disabled_row.POS}" id="block_item_{disabled_row.ID}" />
				</li>
				<!-- END disabled_row-->
			</ul>
			<div style="clear:both;"></div>
		</div>
	</div>
	<div style="clear:both;"></div>
	
	<div style="clear:both;"></div>
	
</div>
<div class="contentFooter">
	<button class="mainoption" name="save" type="submit" id="save"><i class="icon-ok"></i>{L_save}</button>
	<button class="liteoption" type="button" name="reset" onclick="window.location='manage_portal.php{SID}&l={LAYOUT_ID}'"><i class="icon-trash"></i>{L_reset}</button>
	<button class="liteoption" name="cancel" type="button" id="cancel" onclick="window.location='manage_portal.php{SID}'"><i class="icon-chevron-left"></i>{L_back}</button>
</div>
<input type="hidden" name="l" value="{LAYOUT_ID}"/>
{CSRF_TOKEN}
</form>