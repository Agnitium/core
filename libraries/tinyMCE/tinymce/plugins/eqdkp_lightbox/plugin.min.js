/**
 * plugin.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */

/*global tinymce:true */

tinymce.PluginManager.add('eqdkp_lightbox', function(editor) {
	function showDialog() {
		var win, data, dom = editor.dom;
		var width, height, imageListCtrl;
		
		console.log(editor);

		win = editor.windowManager.open({
			title: "Create Thumbnail",
			data: data,
			file: "../dialog.php",
			onSubmit: function(e) {
				var data = e.data;
				
				if (data.item !== ''){
					editor.execCommand('mceInsertContent', false, '{{item::'+data.item+'}}');
				}
			}
		});
	}

	editor.addButton('eqdkp_lightbox', {
		icon: 'zoom-in',
		tooltip: 'Create Thumbnail',
		onclick: showDialog,
	});

	editor.addMenuItem('eqdkp_lightbox', {
		icon: 'zoom-in',
		text: 'Create Image Thumbnail',
		onclick: showDialog,
		context: 'insert',
		prependToContext: true
	});
});